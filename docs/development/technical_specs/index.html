<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Technical Architecture: The Inner Workings of Lynx FIM# This document details my technical research and the design choices I‚Äôve made for the Lynx FIM architecture. I‚Äôm focusing on ‚Äúbest practice‚Äù implementations for integrity and performance as I learn the ropes of HIDS development.
1. Core Technology: Why Go?# I‚Äôve chosen Go (Golang) as the foundation for this project for several reasons:
Low-Level Control with High-Level Productivity: Go gives me the performance I need for file hashing while providing a safe and productive environment for building the alerting system. Static Compilation: A single binary with no external dependencies is a massive security benefit. I don‚Äôt need to worry about the target server having the right version of Python or OpenSSL. Concurrency: Go‚Äôs goroutines will let me handle real-time file events and webhook alerting concurrently without blocking the main monitoring loop. 2. Cryptographic Strategy# To ensure data integrity, I‚Äôm using a two-layered approach:
"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://ItsAdam01.github.io/Lynx/docs/development/technical_specs/"><meta property="og:site_name" content="Lynx FIM Documentation"><meta property="og:title" content="Technical Specifications"><meta property="og:description" content="Technical Architecture: The Inner Workings of Lynx FIM# This document details my technical research and the design choices I‚Äôve made for the Lynx FIM architecture. I‚Äôm focusing on ‚Äúbest practice‚Äù implementations for integrity and performance as I learn the ropes of HIDS development.
1. Core Technology: Why Go?# I‚Äôve chosen Go (Golang) as the foundation for this project for several reasons:
Low-Level Control with High-Level Productivity: Go gives me the performance I need for file hashing while providing a safe and productive environment for building the alerting system. Static Compilation: A single binary with no external dependencies is a massive security benefit. I don‚Äôt need to worry about the target server having the right version of Python or OpenSSL. Concurrency: Go‚Äôs goroutines will let me handle real-time file events and webhook alerting concurrently without blocking the main monitoring loop. 2. Cryptographic Strategy# To ensure data integrity, I‚Äôm using a two-layered approach:"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="docs"><meta itemprop=name content="Technical Specifications"><meta itemprop=description content="Technical Architecture: The Inner Workings of Lynx FIM# This document details my technical research and the design choices I‚Äôve made for the Lynx FIM architecture. I‚Äôm focusing on ‚Äúbest practice‚Äù implementations for integrity and performance as I learn the ropes of HIDS development.
1. Core Technology: Why Go?# I‚Äôve chosen Go (Golang) as the foundation for this project for several reasons:
Low-Level Control with High-Level Productivity: Go gives me the performance I need for file hashing while providing a safe and productive environment for building the alerting system. Static Compilation: A single binary with no external dependencies is a massive security benefit. I don‚Äôt need to worry about the target server having the right version of Python or OpenSSL. Concurrency: Go‚Äôs goroutines will let me handle real-time file events and webhook alerting concurrently without blocking the main monitoring loop. 2. Cryptographic Strategy# To ensure data integrity, I‚Äôm using a two-layered approach:"><meta itemprop=wordCount content="449"><title>Technical Specifications | Lynx FIM Documentation</title><link rel=icon href=/Lynx/favicon.png><link rel=manifest href=/Lynx/manifest.json><link rel=canonical href=https://ItsAdam01.github.io/Lynx/docs/development/technical_specs/><link rel=stylesheet href=/Lynx/book.min.cc2c524ed250aac81b23d1f4af87344917b325208841feca0968fe450f570575.css integrity="sha256-zCxSTtJQqsgbI9H0r4c0SRezJSCIQf7KCWj+RQ9XBXU=" crossorigin=anonymous><script defer src=/Lynx/fuse.min.js></script><script defer src=/Lynx/en.search.min.a3decc09741295e7b8e0634c1bf86f3f3ee6f07f338b11d9bc2ea2d65e329232.js integrity="sha256-o97MCXQSlee44GNMG/hvPz7m8H8zixHZvC6i1l4ykjI=" crossorigin=anonymous></script></head><body dir=ltr class="book-kind-page book-type-docs"><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/Lynx/><span>Lynx FIM Documentation</span></a></h2><div class="book-search hidden"><input id=book-search-input type=text placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li><a href=/Lynx/docs/usage/installation/>Installation & Setup</a></li><li><a href=/Lynx/docs/usage/features/>General Features</a></li><li><a href=/Lynx/docs/development/requirements/>Requirements</a></li><li><a href=/Lynx/docs/usage/commands/>Command Reference</a></li><li><a href=/Lynx/docs/development/technical_specs/ class=active>Technical Specifications</a></li><li><a href=/Lynx/docs/development/implementation_plan/>Implementation Plan</a></li><li><a href=/Lynx/docs/usage/isolated_testing/>Isolated Lab Testing (Experimental)</a></li><li><a href=/Lynx/docs/development/implementation_story/>Implementation Story</a></li><li><a href=/Lynx/docs/development/demonstration/>Demonstration & Proof of Concept</a></li><li><a href=/Lynx/docs/development/performance/>Performance Analysis</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class="book-header hidden"><div class="flex align-center justify-between"><label for=menu-control><img src=/Lynx/icons/menu.svg class=book-icon alt=Menu></label><h3>Technical Specifications</h3><label for=toc-control><img src=/Lynx/icons/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class=hidden><nav id=TableOfContents><ul><li><a href=#1-core-technology-why-go>1. Core Technology: Why Go?</a></li><li><a href=#2-cryptographic-strategy>2. Cryptographic Strategy</a><ul><li><a href=#sha-256-for-file-hashing>SHA-256 for File Hashing</a></li><li><a href=#hmac-for-baseline-protection>HMAC for Baseline Protection</a></li></ul></li><li><a href=#3-real-time-event-loop>3. Real-Time Event Loop</a><ul><li><a href=#how-it-works>How it Works:</a></li></ul></li><li><a href=#4-data-structures--schemas>4. Data Structures & Schemas</a><ul><li><a href=#configuration-file-configyaml>Configuration File (<code>config.yaml</code>)</a></li><li><a href=#baseline-storage-baselinejson>Baseline Storage (<code>baseline.json</code>)</a></li></ul></li><li><a href=#5-security-constraints>5. Security Constraints</a></li><li><a href=#-navigation>üó∫Ô∏è Navigation</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=technical-architecture-the-inner-workings-of-lynx-fim>Technical Architecture: The Inner Workings of Lynx FIM<a class=anchor href=#technical-architecture-the-inner-workings-of-lynx-fim>#</a></h1><p>This document details my technical research and the design choices I&rsquo;ve made for the Lynx FIM architecture. I&rsquo;m focusing on &ldquo;best practice&rdquo; implementations for integrity and performance as I learn the ropes of HIDS development.</p><h2 id=1-core-technology-why-go>1. Core Technology: Why Go?<a class=anchor href=#1-core-technology-why-go>#</a></h2><p>I&rsquo;ve chosen Go (Golang) as the foundation for this project for several reasons:</p><ul><li><strong>Low-Level Control with High-Level Productivity:</strong> Go gives me the performance I need for file hashing while providing a safe and productive environment for building the alerting system.</li><li><strong>Static Compilation:</strong> A single binary with no external dependencies is a massive security benefit. I don&rsquo;t need to worry about the target server having the right version of Python or OpenSSL.</li><li><strong>Concurrency:</strong> Go&rsquo;s goroutines will let me handle real-time file events and webhook alerting concurrently without blocking the main monitoring loop.</li></ul><h2 id=2-cryptographic-strategy>2. Cryptographic Strategy<a class=anchor href=#2-cryptographic-strategy>#</a></h2><p>To ensure data integrity, I&rsquo;m using a two-layered approach:</p><h3 id=sha-256-for-file-hashing>SHA-256 for File Hashing<a class=anchor href=#sha-256-for-file-hashing>#</a></h3><p>I&rsquo;m using the <code>crypto/sha256</code> package from Go&rsquo;s standard library.</p><ul><li><strong>Reasoning:</strong> SHA-256 is the industry standard for integrity checks. It&rsquo;s collision-resistant and provides a 256-bit hash that&rsquo;s perfect for identifying even a single-bit change in a multi-gigabyte file.</li></ul><h3 id=hmac-for-baseline-protection>HMAC for Baseline Protection<a class=anchor href=#hmac-for-baseline-protection>#</a></h3><p>I&rsquo;m using <code>crypto/hmac</code> to protect the <code>baseline.json</code> file.</p><ul><li><strong>Problem:</strong> If an attacker modifies a system file, they might try to also modify the baseline to match the new hash.</li><li><strong>Solution:</strong> When I generate the baseline, I&rsquo;ll also generate a signature of the entire file using an HMAC secret. The agent will re-calculate this signature every time it starts. Without the secret key, an attacker cannot generate a valid signature for a tampered baseline.</li></ul><h2 id=3-real-time-event-loop>3. Real-Time Event Loop<a class=anchor href=#3-real-time-event-loop>#</a></h2><p>I&rsquo;m using the <code>fsnotify</code> library, which wraps the Linux <code>inotify</code> system call.</p><h3 id=how-it-works>How it Works:<a class=anchor href=#how-it-works>#</a></h3><ol><li><strong>Watch Initialization:</strong> The agent recursively walks through the configured directories and adds an <code>inotify</code> watch to each one.</li><li><strong>Kernel Hook:</strong> When a file event occurs (e.g., <code>IN_MODIFY</code>), the kernel puts a message into a buffer for the agent.</li><li><strong>Event Handler:</strong> The agent reads from this buffer, identifies the file path, and triggers the anomaly detection logic.</li></ol><h2 id=4-data-structures--schemas>4. Data Structures & Schemas<a class=anchor href=#4-data-structures--schemas>#</a></h2><h3 id=configuration-file-configyaml>Configuration File (<code>config.yaml</code>)<a class=anchor href=#configuration-file-configyaml>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>agent_name</span>: <span style=color:#e6db74>&#34;dev-lab-01&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>hmac_secret_env</span>: <span style=color:#e6db74>&#34;LYNX_HMAC_SECRET&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>log_file</span>: <span style=color:#e6db74>&#34;/var/log/lynx.log&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>webhook_url</span>: <span style=color:#e6db74>&#34;https://discord.com/api/webhooks/...&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>directories_to_watch</span>:
</span></span><span style=display:flex><span>  - <span style=color:#e6db74>&#34;/etc/ssh&#34;</span>
</span></span><span style=display:flex><span>  - <span style=color:#e6db74>&#34;/usr/local/bin&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>files_to_watch</span>:
</span></span><span style=display:flex><span>  - <span style=color:#e6db74>&#34;/etc/passwd&#34;</span>
</span></span><span style=display:flex><span>  - <span style=color:#e6db74>&#34;/etc/hosts&#34;</span></span></span></code></pre></div><h3 id=baseline-storage-baselinejson>Baseline Storage (<code>baseline.json</code>)<a class=anchor href=#baseline-storage-baselinejson>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;metadata&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;generated_at&#34;</span>: <span style=color:#e6db74>&#34;2025-06-20T14:00:00-04:00&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;total_files&#34;</span>: <span style=color:#ae81ff>128</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;hashes&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;/etc/passwd&#34;</span>: <span style=color:#e6db74>&#34;e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;/etc/ssh/sshd_config&#34;</span>: <span style=color:#e6db74>&#34;8b1a9953c4611296a827abf8c47804d7e6c49c6b&#34;</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;signature&#34;</span>: <span style=color:#e6db74>&#34;a94a8fe5ccb19ba61c4c0873d391e987982fbbd3&#34;</span>
</span></span><span style=display:flex><span>}</span></span></code></pre></div><h2 id=5-security-constraints>5. Security Constraints<a class=anchor href=#5-security-constraints>#</a></h2><ul><li><strong>Sensitive Data:</strong> The <code>LYNX_HMAC_SECRET</code> must be provided as an environment variable. The agent will panic and exit if it&rsquo;s not present.</li><li><strong>Privilege:</strong> The agent will need to run with <code>sudo</code> (root) permissions to read sensitive system files and create the <code>inotify</code> watches.</li></ul><hr><h2 id=-navigation>üó∫Ô∏è Navigation<a class=anchor href=#-navigation>#</a></h2><ul><li><strong><a href=/Lynx/docs/development/requirements/>Requirements</a></strong>: Theoretical foundation for the HIDS.</li><li><strong><a href=/Lynx/docs/development/implementation_plan/>Implementation Plan</a></strong>: Project roadmap.</li><li><strong><a href=/Lynx/docs/>Back to Introduction</a></strong></li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div></div><div></div></div><div class="flex flex-wrap justify-between"><span><a href=/Lynx/docs/usage/commands/ class="flex align-center"><img src=/Lynx/icons/backward.svg class=book-icon alt=Backward>
<span>Command Reference</span>
</a></span><span><a href=/Lynx/docs/development/implementation_plan/ class="flex align-center"><span>Implementation Plan</span>
<img src=/Lynx/icons/forward.svg class=book-icon alt=Forward></a></span></div><div class=book-comments></div><script>(function(){document.querySelectorAll("pre:has(code)").forEach(e=>{e.addEventListener("click",e.focus),e.addEventListener("copy",function(t){if(t.preventDefault(),navigator.clipboard){const t=window.getSelection().toString()||e.textContent;navigator.clipboard.writeText(t)}})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#1-core-technology-why-go>1. Core Technology: Why Go?</a></li><li><a href=#2-cryptographic-strategy>2. Cryptographic Strategy</a><ul><li><a href=#sha-256-for-file-hashing>SHA-256 for File Hashing</a></li><li><a href=#hmac-for-baseline-protection>HMAC for Baseline Protection</a></li></ul></li><li><a href=#3-real-time-event-loop>3. Real-Time Event Loop</a><ul><li><a href=#how-it-works>How it Works:</a></li></ul></li><li><a href=#4-data-structures--schemas>4. Data Structures & Schemas</a><ul><li><a href=#configuration-file-configyaml>Configuration File (<code>config.yaml</code>)</a></li><li><a href=#baseline-storage-baselinejson>Baseline Storage (<code>baseline.json</code>)</a></li></ul></li><li><a href=#5-security-constraints>5. Security Constraints</a></li><li><a href=#-navigation>üó∫Ô∏è Navigation</a></li></ul></nav></div></aside></main></body></html>